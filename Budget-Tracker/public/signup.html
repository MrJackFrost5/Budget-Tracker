<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <h1>Sign Up</h1>
    <label for="username-input">Username:</label>
    <input class="text-area-a my-2" id="username-input" type="text" required><br>

    <label for="password-input">Password:</label>
    <input class="text-area-a my-2" id="password-input" type="password" required><br>

    <label for="firstname-input">First Name:</label>
    <input class="text-area-a my-2" id="firstname-input" type="text" required><br>

    <label for="lastname-input">Last Name:</label>
    <input class="text-area-a my-2" id="lastname-input" type="text" required><br>

    <label for="email-input">Email:</label>
    <input class="text-area-a my-2" id="email-input" type="email" required><br>

    <button type="submit" id="submit-btn">Sign Up</button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>

        const baseUrl = "http://localhost:3000/";

        document.getElementById('submit-btn').addEventListener('click', async (event) => {
            event.preventDefault(); // Prevent form from refreshing the page. do NOT let them refresh

            // Collect the input values
            const userData = {
                username: document.getElementById('username-input').value,
                firstname: document.getElementById('firstname-input').value,
                lastname: document.getElementById('lastname-input').value,
                password: document.getElementById('password-input').value,
                email: document.getElementById('email-input').value,
                creation_date: new Date(),
                last_logged_in: new Date(),
                has_access: true,
                credit_score: 50
            };

            // Send user data to the backend
            try {
                const response = await fetch(baseUrl + "create_account", {
                    method: 'POST',
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(userData)
                });
                
                if (response.ok) {
                    const newUser = await response.json();
                    console.log("User created successfully:", newUser);
                    // ok now redirect user to home page
                } else {
                    console.error("Failed to create user");
                }
            } catch (error) {
                console.error("Error:", error);
            }
        });
    </script>
</body>
</html>
